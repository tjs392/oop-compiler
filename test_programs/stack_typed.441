class ListNode [
    fields val:int, next:ListNode
    method getNext() returning ListNode with locals:
        return &this.next
    method getVal() returning int with locals:
        return &this.val
]
class Stack [
    fields list:ListNode
    method push(v:int) returning int with locals tmp:ListNode:
        tmp = @ListNode
        !tmp.val = v
        !tmp.next = &this.list
        !this.list = tmp
        return 0
    method pop() returning int with locals tmp:int, head:ListNode:
        if (&this.list == null:ListNode): {
            return 0
        } else {
            head = &this.list
            tmp = ^head.getVal()
            !this.list = ^head.getNext()
            return tmp
        }
]
class Stacker [
    fields
    method do(stk:Stack) returning int with locals x:int, v:int:
        x = 20
        while (x > 0): {
            _ = ^stk.push(x)
            x = (x - 1)
        }
        v = ^stk.pop()
        while (v != 0): {
            print(v)
            v = ^stk.pop()
        }
        return 0
]

main with stk:Stack, stkr:Stacker:
    stk = @Stack
    !stk.list = null:ListNode
    stkr = @Stacker
    _ = ^stkr.do(stk)